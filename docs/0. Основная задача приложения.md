Приложение отображает дерево чекбоксов, где каждый узел может быть отмечен, не отмечен или находиться в промежуточном состоянии. Пользователь может сворачивать и разворачивать узлы дерева, а также управлять состояниями дочерних элементов через родительские узлы.

### Основные функциональные элементы приложения:

1. **Компонент дерева чекбоксов**:
    
    - В приложении используется рекурсивный компонент `TreeCheckbox`, который отображает узел дерева, его состояние (чекбокс), и, при наличии, его дочерние узлы.
    - Если у узла есть дочерние элементы, можно развернуть/свернуть его с помощью иконок (стрелок).
2. **Три состояния чекбоксов**:
    
    - **Checked**: Если узел и все его дочерние узлы отмечены.
    - **Unchecked**: Если узел и все его дочерние узлы не отмечены.
    - **Indeterminate** (промежуточное состояние): Если часть дочерних узлов отмечена, а часть нет.

### Шаблон и структура дерева:

Компонент отображает каждый узел дерева в виде списка `<ul>`, где каждый элемент — это `<li>`, содержащий чекбокс и текст. Для узлов с дочерними элементами показываются стрелочки для разворачивания и сворачивания

```TS
<template>
  <ul>
    <li>
      <!-- Стрелочка для сворачивания/разворачивания узла -->
      <span class="toggle-icon" @click="toggleCollapse" v-if="node.children && node.children.length">
        {{ isCollapsed ? '▶' : '▼' }}
      </span>
      <!-- Чекбокс для узла -->
      <label class="tree-label">
        <input
          type="checkbox"
          :indeterminate="node.checked === null"
          :checked="node.checked === true"
          @change="toggle"
        />
        <span class="checkbox-label">{{ node.label }}</span>
      </label>
      <!-- Рекурсивное отображение дочерних узлов -->
      <ul v-if="!isCollapsed && node.children && node.children.length" class="nested-tree">
        <TreeCheckbox
          v-for="(child, index) in node.children"
          :key="index"
          :node="child"
          @update="updateChildren"
        />
      </ul>
    </li>
  </ul>
</template>
```

### Основные функции:

1. **Функция `toggle`**:
    - Эта функция вызывается, когда пользователь изменяет состояние чекбокса. Она переключает текущее состояние узла и его дочерних элементов.
    - Если узел не отмечен, он становится отмеченным, и все дочерние узлы также отмечаются. Если узел был отмечен, то он и все его дочерние узлы снимаются.

```TS
const toggle = () => {
  if (props.node.checked === false || props.node.checked === null) {
    props.node.checked = true;
    setAllChildrenChecked(props.node, true);
  } else {
    props.node.checked = false;
    setAllChildrenChecked(props.node, false);
  }
  emit('update');
};
```

2. **Функция `setAllChildrenChecked`**:
    - Эта функция рекурсивно изменяет состояние всех дочерних узлов. Если родительский узел отмечен, все его дочерние узлы также будут отмечены. Если родительский узел снят, то и дочерние узлы будут сняты.

```TS
const setAllChildrenChecked = (node: TreeNode, checked: boolean) => {
  if (node.children) {
    node.children.forEach((child) => {
      child.checked = checked;
      setAllChildrenChecked(child, checked);  // Рекурсия для всех дочерних узлов
    });
  }
};
```

3. **Функция `updateChildren`**:
    - Эта функция пересчитывает состояние родительского узла, основываясь на состояниях его дочерних узлов. Если все дочерние узлы отмечены, родительский узел также отмечается. Если все дочерние узлы сняты, родительский узел снимается. Если состояния разные, то родительский узел переходит в промежуточное состояние.

```TS
const updateChildren = () => {
  const checkedChildren = Array.isArray(props.node.children)
    ? props.node.children.filter((child) => child.checked === true).length
    : 0;
  const uncheckedChildren = Array.isArray(props.node.children)
    ? props.node.children.filter((child) => child.checked === false).length
    : 0;
  const intermediateChildren = Array.isArray(props.node.children)
    ? props.node.children.filter((child) => child.checked === null).length
    : 0;

  if (checkedChildren === props.node.children?.length) {
    props.node.checked = true;
  } else if (uncheckedChildren === props.node.children?.length && intermediateChildren === 0) {
    props.node.checked = false;
  } else {
    props.node.checked = null;
  }

  emit('update');
};
```

4. **Функция `toggleCollapse`**:
    - Эта функция позволяет пользователю сворачивать и разворачивать узлы дерева. Она изменяет состояние `isCollapsed`, контролирующее, показываются ли дочерние элементы.

```TS
const toggleCollapse = () => {
  isCollapsed.value = !isCollapsed.value;
};
```

### Логика взаимодействия:

- Когда пользователь кликает по чекбоксу родительского узла, состояние узла меняется и применяется ко всем дочерним узлам.
- Если пользователь изменяет состояние дочернего узла, это вызывает функцию `updateChildren`, которая проверяет, должны ли измениться состояния родительских узлов (включая промежуточное состояние).
- Сворачивание и разворачивание узлов позволяет пользователю скрывать или показывать вложенные элементы дерева, что помогает работать с большими и сложными структурами данных.

### Визуальная часть:

- Стрелочки (`▶` и `▼`) показывают, что узел можно свернуть или развернуть.
- Промежуточное состояние чекбоксов (квадратик внутри чекбокса) помогает визуально определить, что часть дочерних элементов выбрана, а часть нет.

### Заключение:

Это приложение позволяет пользователям удобно управлять состояниями элементов в древовидной структуре. Пользователь может взаимодействовать с чекбоксами и сворачивать/разворачивать узлы, а состояние родительских и дочерних узлов обновляется автоматически в зависимости от действий пользователя.