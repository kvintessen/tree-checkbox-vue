Vue понимает, что нужно вызвать функцию `toggle`, благодаря механизму привязки событий через директиву `v-on`, которая используется для отслеживания событий на элементах. В случае с твоим кодом, это делается через директиву `@change`, которая является сокращением для `v-on:change`.

### Как это работает:

1. **Привязка событий через директиву `v-on`**: В Vue есть специальная директива `v-on`, которая позволяет "слушать" события на элементах. Она связывает событие с конкретным методом в компоненте.
    
2. **Сокращенная запись `@change`**: Для удобства, Vue предоставляет сокращённую запись `@` вместо полного `v-on`. То есть, `@change="toggle"` означает, что когда произойдёт событие `change` на элементе (например, на чекбоксе), будет вызвана функция `toggle`.

Пример в коде:

```TS
<input
  type="checkbox"
  :indeterminate="node.checked === null"
  :checked="node.checked === true"
  @change="toggle"
/>
```

- **`@change="toggle"`** — означает, что Vue будет отслеживать событие `change` на этом элементе (в данном случае на чекбоксе), и когда событие произойдет (например, при изменении состояния чекбокса), Vue автоматически вызовет метод `toggle`, который находится в блоке `setup` или `methods`.

### Что делает Vue:

1. Vue рендерит этот элемент `<input type="checkbox">` на странице.
2. Vue отслеживает событие `change` на этом элементе.
3. Когда пользователь кликает по чекбоксу, срабатывает событие `change`.
4. Vue автоматически вызывает функцию `toggle`, которая была привязана к этому событию через директиву `@change`.

### Вызов метода `toggle`:

Когда Vue вызывает метод `toggle`, происходит следующее:

1. Vue передает контроль в функцию `toggle`, которая прописана в логике компонента.
2. В зависимости от текущего состояния узла (отмечен, не отмечен или промежуточное состояние), функция изменяет состояние узла и его дочерних элементов.

Пример функции `toggle`:

```TS
const toggle = () => {
  if (props.node.checked === false || props.node.checked === null) {
    props.node.checked = true;
    setAllChildrenChecked(props.node, true);
  } else {
    props.node.checked = false;
    setAllChildrenChecked(props.node, false);
  }
  emit('update');  // Сообщаем об изменении состояния
};
```

- Функция `toggle` проверяет текущее состояние чекбокса. Если узел не отмечен, он становится отмеченным, а также отмечаются все дочерние элементы. Если узел был отмечен, то он снимается, и дочерние узлы тоже снимаются.
- Функция `emit('update')` сообщает об изменении состояния родительскому компоненту.

### Резюме:

Vue использует директиву `@change`, чтобы отслеживать событие `change` на элементе и вызвать функцию `toggle` в момент, когда это событие происходит (например, когда пользователь изменяет состояние чекбокса).